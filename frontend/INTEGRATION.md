# 前端后端接口集成说明

## 🔗 接口集成状态

### ✅ 已集成接口

#### 1. 用户认证
- **登录接口**: `POST /api/auth/login`
- **注册接口**: `POST /api/auth/register`

#### 2. 帖子管理
- **发布帖子**: `POST /api/post/publish`

#### 3. 好友管理
- **发送好友请求**: `POST /api/friend/apply`

### 📁 文件结构

```
src/
├── api/
│   ├── auth.js          # 认证相关API调用
│   ├── post.js          # 帖子相关API调用
│   └── friend.js        # 好友相关API调用
├── utils/
│   └── auth.js          # 认证工具函数
└── views/
    ├── auth/
    │   ├── Login.vue    # 登录页面（已接入API）
    │   └── Register.vue # 注册页面（已接入API）
    ├── Publish.vue      # 发布页面（已接入API）
    └── Friends.vue      # 好友页面（已接入API）
```

## 🛠️ 技术实现

### 1. API 服务层
#### 认证服务 (`src/api/auth.js`)
- 使用 axios 创建 HTTP 客户端
- 配置请求/响应拦截器
- 自动添加 JWT Token 到请求头
- 统一错误处理

#### 帖子服务 (`src/api/post.js`)
- 发布帖子接口
- 帖子列表和详情接口（已准备）
- 点赞、收藏功能接口（已准备）

#### 好友服务 (`src/api/friend.js`)
- 发送好友请求接口
- 好友申请管理接口（已准备）
- 好友列表和删除接口（已准备）

### 2. 认证工具 (`src/utils/auth.js`)
- Token 存储和获取
- 用户信息管理
- 登录状态检查
- 登出功能

### 3. 页面组件
- 使用 Element Plus 表单组件
- 表单验证
- 加载状态管理
- 错误提示

## 🔐 认证流程

### 登录流程
1. 用户输入用户名和密码
2. 前端验证表单数据
3. 调用 `/api/auth/login` 接口
4. 成功：存储 token 和用户信息，跳转到首页
5. 失败：显示错误提示

### 注册流程
1. 用户填写注册信息
2. 前端验证表单数据（包括密码确认）
3. 调用 `/api/auth/register` 接口（仅传递 username 和 password）
4. 成功：跳转到登录页面
5. 失败：显示错误提示

## 📝 帖子发布流程

### 发布流程
1. 用户填写帖子信息（标题、内容、标签）
2. 前端验证表单数据
3. 调用 `/api/post/publish` 接口
4. 成功：显示"发布成功"并跳转到首页
5. 失败：显示错误提示

## 👥 好友请求流程

### 发送请求流程
1. 用户输入目标用户ID
2. 前端验证用户ID格式（必须是数字）
3. 调用 `/api/friend/apply` 接口
4. 成功：显示"请求已发送"并清空输入框
5. 失败：显示错误提示

## 📦 请求参数

### 登录请求
```json
{
  "username": "用户名",
  "password": "密码"
}
```

### 注册请求
```json
{
  "username": "用户名", 
  "password": "密码",
  "nickname": "昵称",
  "email": "example@example.com"
}
```

### 发布帖子请求
```json
{
  "title": "帖子标题（可选）",
  "content": "帖子内容（必填）", 
  "tags": "标签1,标签2,标签3",
  "type": 1,
  "location": "位置信息（可选）"
}
```

### 发送好友请求
```json
{
  "friendId": 123,
  "reason": "希望成为好友",
  "remark": "同学"
}
```

## 📬 响应格式

后端返回的统一响应格式：
```json
{
  "code": 200,
  "message": "success",
  "data": {
    // 具体数据内容
  }
}
```

### 登录响应
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "token": "jwt_token_string",
    "tokenType": "Bearer",
    "expiresIn": 3600000,
    "userInfo": {
      "id": 1,
      "username": "用户名",
      "nickname": "昵称"
    }
  }
}
```

### 发布帖子响应
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 123,
    "title": "帖子标题",
    "content": "帖子内容",
    "createTime": "2024-01-01 12:00:00"
  }
}
```

### 发送好友请求响应
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 456,
    "userId": 1,
    "targetUserId": 123,
    "status": 0,
    "createTime": "2024-01-01 12:00:00"
  }
}
```

## 🔧 配置

### Vite 代理配置
```javascript
server: {
  proxy: {
    '/api': {
      target: 'http://localhost:8080',
      changeOrigin: true
    }
  }
}
```

### Axios 配置
- 基础URL: `http://localhost:8080/api`
- 超时时间: 5秒
- 自动JWT认证头

## 🚀 使用方式

### 启动项目
```bash
# 确保后端服务已启动 (localhost:8080)
npm run dev  # 前端启动在 localhost:3000
```

### 测试登录
1. 访问 http://localhost:3000/login
2. 输入后端已注册的用户名和密码
3. 点击登录按钮

### 测试注册
1. 访问 http://localhost:3000/register
2. 输入用户名和密码
3. 点击注册按钮
4. 注册成功后跳转到登录页

### 测试发布帖子
1. 登录后访问 http://localhost:3000/publish
2. 填写帖子标题（可选）
3. 填写帖子内容（必填）
4. 添加标签（可选）
5. 点击"发布动态"按钮
6. 成功后跳转到首页

### 测试添加好友
1. 登录后访问 http://localhost:3000/friends
2. 在"直接添加好友"区域输入用户ID
3. 点击"发送请求"按钮
4. 成功后显示"请求已发送"

## 🛡️ 安全特性

- JWT Token 自动管理
- 401 状态码自动登出
- 密码字段自动隐藏
- 表单数据验证
- HTTPS 支持（生产环境）

## 📋 功能特点

### 发布页面功能
- **多类型支持**: 文字、图片、视频、链接类型
- **丰富编辑**: 标题、内容、标签、位置信息
- **实时预览**: 右侧实时预览发布效果
- **标签系统**: 支持自定义标签和热门标签选择
- **表单验证**: 内容长度限制、格式验证
- **响应式设计**: 移动端适配

### 好友页面功能
- **用户搜索**: 按关键词搜索用户
- **直接添加**: 通过用户ID直接发送好友请求
- **申请管理**: 查看并处理好友申请
- **好友列表**: 查看已添加的好友
- **统计信息**: 好友数量、在线状态等统计
- **推荐功能**: 显示可能认识的人

### 已集成的后端接口功能
- **用户认证**: 完整的登录注册流程
- **帖子发布**: 支持标题、内容、标签参数传递
- **好友请求**: 支持通过用户ID发送好友申请
- **错误处理**: 统一的错误提示和处理机制
- **状态管理**: 加载状态、成功跳转

## 📋 待扩展功能

- [ ] 帖子列表页面接口集成
- [ ] 帖子详情页面接口集成
- [ ] 点赞收藏功能接口集成
- [ ] 评论功能接口集成
- [ ] 好友申请列表接口集成
- [ ] 好友列表接口集成
- [ ] 用户搜索接口集成
- [ ] 文件上传功能
- [ ] 忘记密码
- [ ] 社交登录
- [ ] 短信验证码
- [ ] 邮箱验证
- [ ] 记住登录状态
- [ ] 双因子认证

---

**集成完成时间**: 2024年1月  
**维护状态**: ✅ 活跃维护 